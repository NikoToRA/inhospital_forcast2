# 入院患者数予測システム

このシステムは、病院の入院患者数を予測するためのWebアプリケーションです。当日の予測と週間予測を提供し、カレンダー形式で月間の予測傾向を表示します。

## 主な機能

- **当日予測**
  - RandomForestモデルを使用した高精度な予測
  - 前日の外来患者数、紹介患者数、救急患者数、ベッド数に基づく予測
  - 予測値の5段階評価（多い、やや多い、標準、やや少ない、少ない）

- **週間予測**
  - Prophetモデルを使用した時系列予測
  - 7日間の予測推移をグラフ表示
  - 予測値の信頼区間を表示

- **月間カレンダー**
  - 月単位での予測傾向をカレンダー形式で表示
  - 5段階評価による色分け表示
  - 曜日や季節性を考慮した予測

## 必要条件

- Python 3.7以上
- 必要なライブラリ：
  - Flask
  - pandas
  - numpy
  - scikit-learn
  - prophet
  - plotly
  - joblib

## セットアップ

1. 必要なライブラリをインストール：
```bash
pip install -r requirements.txt
```

2. 予測モデルファイルを配置：
   - `fixed_rf_model.joblib`（RandomForestモデル）
   - `prophet_model.joblib`（Prophetモデル）
   をプロジェクトのルートディレクトリに配置

## 使用方法

1. アプリケーションを起動：
```bash
python run.py
```

2. ブラウザでアクセス：
```
http://localhost:5000
```

3. 予測フォームに情報を入力：
   - 予測日付
   - 前日の外来患者総数
   - 前日の紹介外来患者数
   - 前日の救急外来患者数
   - 現在の入院患者数

4. 「予測実行」ボタンをクリック

5. 予測結果の確認：
   - 当日の予測入院患者数（高精度予測）
   - 週間予測推移グラフ
   - 月間カレンダーでの予測傾向

## 予測モデルについて

### RandomForestモデル（当日予測用）
- より正確な予測を提供
- 以下の特徴量を使用：
  - 外来患者数
  - 紹介患者数
  - 救急患者数
  - ベッド数
  - 曜日
  - 月
  - 年
  - 休日フラグ

### Prophetモデル（週間予測用）
- 時系列データの特徴を捉えた予測
- 季節性やトレンドを考慮
- 予測値の信頼区間を提供

## 注意事項

- 予測値は参考値として使用してください
- 当日予測は週間予測よりも精度が高い予測値を提供します
- 予測モデルは定期的な再学習が必要です
- 本番環境では適切なセキュリティ設定を行ってください

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。 